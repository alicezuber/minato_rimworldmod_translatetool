<UserControl x:Class="RimWorldTranslationTool.Views.ModBrowserView"
             xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
             xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
             mc:Ignorable="d"
             d:DesignHeight="700" d:DesignWidth="1100">
    
    <Grid Margin="32,24">
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="*"/>
        </Grid.RowDefinitions>
        
        <!-- é é¢æ¨™é¡Œ -->
        <StackPanel Grid.Row="0" Margin="0,0,0,24">
            <TextBlock Text="æ¨¡çµ„ç€è¦½å™¨" 
                       FontSize="28" 
                       FontWeight="Bold" 
                       Foreground="{StaticResource TextPrimaryBrush}"/>
            <TextBlock Text="æŽƒæä¸¦ç€è¦½å·²å®‰è£çš„æ¨¡çµ„ï¼Œæª¢è¦–ç¿»è­¯ç‹€æ…‹" 
                       FontSize="14" 
                       Foreground="{StaticResource TextSecondaryBrush}"
                       Margin="0,8,0,0"/>
        </StackPanel>
        
        <!-- å·¥å…·åˆ— -->
        <Border Grid.Row="1" Style="{StaticResource Card}" Margin="0,0,0,20" Padding="16">
            <Grid>
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="Auto"/>
                    <ColumnDefinition Width="*"/>
                    <ColumnDefinition Width="Auto"/>
                </Grid.ColumnDefinitions>
                
                <StackPanel Orientation="Horizontal">
                    <Button Content="ðŸ” æŽƒææ¨¡çµ„" 
                            Style="{StaticResource PrimaryButton}"
                            Command="{Binding ScanCommand}"/>
                    <TextBlock Text="{Binding StatusText}" 
                               VerticalAlignment="Center" 
                               Margin="16,0,0,0"
                               FontSize="13"
                               Foreground="{StaticResource TextSecondaryBrush}"/>
                </StackPanel>
                
                <!-- æœå°‹æ¡† -->
                <TextBox Grid.Column="1" 
                         Style="{StaticResource ModernTextBox}"
                         Text="{Binding SearchText, UpdateSourceTrigger=PropertyChanged}"
                         Margin="24,0"/>
                
                <!-- çµ±è¨ˆ -->
                <TextBlock Grid.Column="2" 
                           Text="{Binding ModCountText}" 
                           VerticalAlignment="Center"
                           FontSize="13"
                           Foreground="{StaticResource TextSecondaryBrush}"/>
            </Grid>
        </Border>
        
        <!-- ä¸»å…§å®¹å€ -->
        <Grid Grid.Row="2">
            <Grid.ColumnDefinitions>
                <ColumnDefinition Width="*" MinWidth="500"/>
                <ColumnDefinition Width="360"/>
            </Grid.ColumnDefinitions>
            
            <!-- æ¨¡çµ„åˆ—è¡¨ -->
            <Border Style="{StaticResource Card}" Margin="0,0,16,0" Padding="0">
                <DataGrid ItemsSource="{Binding FilteredMods}"
                          SelectedItem="{Binding SelectedMod}"
                          AutoGenerateColumns="False"
                          IsReadOnly="True"
                          SelectionMode="Single"
                          GridLinesVisibility="None"
                          HeadersVisibility="Column"
                          Background="Transparent"
                          BorderThickness="0"
                          RowBackground="{StaticResource BgSecondaryBrush}"
                          AlternatingRowBackground="{StaticResource BgTertiaryBrush}">
                    
                    <DataGrid.ColumnHeaderStyle>
                        <Style TargetType="DataGridColumnHeader">
                            <Setter Property="Background" Value="{StaticResource BgTertiaryBrush}"/>
                            <Setter Property="Foreground" Value="{StaticResource TextSecondaryBrush}"/>
                            <Setter Property="Padding" Value="16,12"/>
                            <Setter Property="FontWeight" Value="SemiBold"/>
                            <Setter Property="FontSize" Value="12"/>
                            <Setter Property="BorderThickness" Value="0"/>
                        </Style>
                    </DataGrid.ColumnHeaderStyle>
                    
                    <DataGrid.RowStyle>
                        <Style TargetType="DataGridRow">
                            <Setter Property="Cursor" Value="Hand"/>
                            <Style.Triggers>
                                <Trigger Property="IsSelected" Value="True">
                                    <Setter Property="Background" Value="{StaticResource AccentBrush}"/>
                                </Trigger>
                                <Trigger Property="IsMouseOver" Value="True">
                                    <Setter Property="Background" Value="{StaticResource BgElevatedBrush}"/>
                                </Trigger>
                            </Style.Triggers>
                        </Style>
                    </DataGrid.RowStyle>
                    
                    <DataGrid.CellStyle>
                        <Style TargetType="DataGridCell">
                            <Setter Property="Padding" Value="16,12"/>
                            <Setter Property="BorderThickness" Value="0"/>
                            <Setter Property="Foreground" Value="{StaticResource TextPrimaryBrush}"/>
                            <Setter Property="Template">
                                <Setter.Value>
                                    <ControlTemplate TargetType="DataGridCell">
                                        <Border Padding="{TemplateBinding Padding}" 
                                                Background="{TemplateBinding Background}">
                                            <ContentPresenter VerticalAlignment="Center"/>
                                        </Border>
                                    </ControlTemplate>
                                </Setter.Value>
                            </Setter>
                        </Style>
                    </DataGrid.CellStyle>
                    
                    <DataGrid.Columns>
                        <DataGridTextColumn Header="æ¨¡çµ„åç¨±" Binding="{Binding Name}" Width="*" MinWidth="200"/>
                        <DataGridTextColumn Header="ä½œè€…" Binding="{Binding Author}" Width="120"/>
                        <DataGridTextColumn Header="ç‰ˆæœ¬" Binding="{Binding SupportedVersions}" Width="80"/>
                        <DataGridTemplateColumn Header="ç¹ä¸­" Width="50">
                            <DataGridTemplateColumn.CellTemplate>
                                <DataTemplate>
                                    <TextBlock Text="{Binding HasChineseTraditional}" 
                                               HorizontalAlignment="Center"
                                               Foreground="{Binding HasChineseTraditionalColor}"/>
                                </DataTemplate>
                            </DataGridTemplateColumn.CellTemplate>
                        </DataGridTemplateColumn>
                        <DataGridTemplateColumn Header="ç°¡ä¸­" Width="50">
                            <DataGridTemplateColumn.CellTemplate>
                                <DataTemplate>
                                    <TextBlock Text="{Binding HasChineseSimplified}" 
                                               HorizontalAlignment="Center"
                                               Foreground="{Binding HasChineseSimplifiedColor}"/>
                                </DataTemplate>
                            </DataGridTemplateColumn.CellTemplate>
                        </DataGridTemplateColumn>
                    </DataGrid.Columns>
                </DataGrid>
            </Border>
            
            <!-- è©³æƒ…é¢æ¿ -->
            <Border Grid.Column="1" Style="{StaticResource Card}">
                <ScrollViewer VerticalScrollBarVisibility="Auto">
                    <StackPanel>
                        <!-- ç©ºç‹€æ…‹ -->
                        <StackPanel Visibility="{Binding SelectedMod, Converter={StaticResource NullToVisibility}}"
                                    HorizontalAlignment="Center"
                                    Margin="0,60,0,0">
                            <TextBlock Text="ðŸ“‹" FontSize="48" HorizontalAlignment="Center" Margin="0,0,0,16"/>
                            <TextBlock Text="é¸æ“‡æ¨¡çµ„ä»¥æŸ¥çœ‹è©³æƒ…" 
                                       FontSize="14" 
                                       Foreground="{StaticResource TextSecondaryBrush}"
                                       HorizontalAlignment="Center"/>
                        </StackPanel>
                        
                        <!-- æ¨¡çµ„è©³æƒ… -->
                        <StackPanel Visibility="{Binding SelectedMod, Converter={StaticResource NullToVisibility}, ConverterParameter=Invert}">
                            
                            <!-- é è¦½åœ– -->
                            <Border Background="{StaticResource BgTertiaryBrush}" 
                                    CornerRadius="8" 
                                    Padding="8" 
                                    Margin="0,0,0,20">
                                <Image Source="{Binding SelectedMod.PreviewImage}" 
                                       MaxHeight="200" 
                                       Stretch="Uniform"/>
                            </Border>
                            
                            <!-- æ¨¡çµ„åç¨± -->
                            <TextBlock Text="{Binding SelectedMod.Name}" 
                                       FontSize="18" 
                                       FontWeight="SemiBold"
                                       Foreground="{StaticResource TextPrimaryBrush}"
                                       TextWrapping="Wrap"
                                       Margin="0,0,0,8"/>
                            
                            <!-- ä½œè€… -->
                            <TextBlock FontSize="13" 
                                       Foreground="{StaticResource TextSecondaryBrush}"
                                       Margin="0,0,0,16">
                                <Run Text="ä½œè€…: "/>
                                <Run Text="{Binding SelectedMod.Author}"/>
                            </TextBlock>
                            
                            <!-- è³‡è¨Šå¡ç‰‡ -->
                            <Border Background="{StaticResource BgTertiaryBrush}" 
                                    CornerRadius="8" 
                                    Padding="14" 
                                    Margin="0,0,0,16">
                                <StackPanel>
                                    <Grid Margin="0,0,0,8">
                                        <Grid.ColumnDefinitions>
                                            <ColumnDefinition Width="*"/>
                                            <ColumnDefinition Width="*"/>
                                        </Grid.ColumnDefinitions>
                                        <TextBlock Text="PackageId" FontSize="12" Foreground="{StaticResource TextMutedBrush}"/>
                                        <TextBlock Grid.Column="1" Text="{Binding SelectedMod.PackageId}" 
                                                   FontSize="12" Foreground="{StaticResource TextSecondaryBrush}"
                                                   TextWrapping="Wrap"/>
                                    </Grid>
                                    <Grid Margin="0,0,0,8">
                                        <Grid.ColumnDefinitions>
                                            <ColumnDefinition Width="*"/>
                                            <ColumnDefinition Width="*"/>
                                        </Grid.ColumnDefinitions>
                                        <TextBlock Text="ç‰ˆæœ¬" FontSize="12" Foreground="{StaticResource TextMutedBrush}"/>
                                        <TextBlock Grid.Column="1" Text="{Binding SelectedMod.SupportedVersions}" 
                                                   FontSize="12" Foreground="{StaticResource TextSecondaryBrush}"/>
                                    </Grid>
                                    <Grid>
                                        <Grid.ColumnDefinitions>
                                            <ColumnDefinition Width="*"/>
                                            <ColumnDefinition Width="*"/>
                                        </Grid.ColumnDefinitions>
                                        <TextBlock Text="è³‡æ–™å¤¾" FontSize="12" Foreground="{StaticResource TextMutedBrush}"/>
                                        <TextBlock Grid.Column="1" Text="{Binding SelectedMod.FolderName}" 
                                                   FontSize="12" Foreground="{StaticResource TextSecondaryBrush}"
                                                   TextWrapping="Wrap"/>
                                    </Grid>
                                </StackPanel>
                            </Border>
                            
                            <!-- ç¿»è­¯ç‹€æ…‹ -->
                            <TextBlock Text="ç¿»è­¯ç‹€æ…‹" 
                                       FontSize="14" 
                                       FontWeight="SemiBold"
                                       Foreground="{StaticResource TextPrimaryBrush}"
                                       Margin="0,0,0,12"/>
                            
                            <Border Background="{StaticResource BgTertiaryBrush}" 
                                    CornerRadius="8" 
                                    Padding="14">
                                <StackPanel>
                                    <Grid Margin="0,0,0,8">
                                        <Grid.ColumnDefinitions>
                                            <ColumnDefinition Width="*"/>
                                            <ColumnDefinition Width="Auto"/>
                                        </Grid.ColumnDefinitions>
                                        <TextBlock Text="ç¹é«”ä¸­æ–‡" FontSize="13" Foreground="{StaticResource TextSecondaryBrush}"/>
                                        <TextBlock Grid.Column="1" Text="{Binding SelectedMod.HasChineseTraditional}" 
                                                   FontSize="13" Foreground="{Binding SelectedMod.HasChineseTraditionalColor}"/>
                                    </Grid>
                                    <Grid Margin="0,0,0,8">
                                        <Grid.ColumnDefinitions>
                                            <ColumnDefinition Width="*"/>
                                            <ColumnDefinition Width="Auto"/>
                                        </Grid.ColumnDefinitions>
                                        <TextBlock Text="ç°¡é«”ä¸­æ–‡" FontSize="13" Foreground="{StaticResource TextSecondaryBrush}"/>
                                        <TextBlock Grid.Column="1" Text="{Binding SelectedMod.HasChineseSimplified}" 
                                                   FontSize="13" Foreground="{Binding SelectedMod.HasChineseSimplifiedColor}"/>
                                    </Grid>
                                    <Grid>
                                        <Grid.ColumnDefinitions>
                                            <ColumnDefinition Width="*"/>
                                            <ColumnDefinition Width="Auto"/>
                                        </Grid.ColumnDefinitions>
                                        <TextBlock Text="ç¿»è­¯è£œä¸" FontSize="13" Foreground="{StaticResource TextSecondaryBrush}"/>
                                        <TextBlock Grid.Column="1" Text="{Binding SelectedMod.HasTranslationPatch}" 
                                                   FontSize="13" Foreground="{Binding SelectedMod.HasTranslationPatchColor}"/>
                                    </Grid>
                                </StackPanel>
                            </Border>
                            
                        </StackPanel>
                    </StackPanel>
                </ScrollViewer>
            </Border>
        </Grid>
    </Grid>
</UserControl>
